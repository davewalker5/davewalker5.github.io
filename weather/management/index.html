---
layout: default
title: Management Reports
permalink: /weather/management/
---

<h1>{{ page.title }}</h1>

{% assign report_root = "/weather/reports/management/" %}

{%- comment -%}
Collect XLSX bases (ignore /_site/)
{%- endcomment -%}
{% assign xlsx_bases = "" | split: "" %}
{% for f in site.static_files %}
  {% if f.path contains report_root %}
    {% unless f.path contains "/_site/" %}
      {% assign filename = f.path | split: "/" | last %}
      {% assign ext = filename | split: "." | last | downcase %}
      {% if ext == "xlsx" %}
        {% assign base = filename | split: "." | first %}
        {% unless xlsx_bases contains base %}
          {% assign xlsx_bases = xlsx_bases | push: base %}
        {% endunless %}
      {% endif %}
    {% endunless %}
  {% endif %}
{% endfor %}

{% assign row_count = 0 %}
{% assign seen_paths = "" | split: "" %}

<table class="data-table">
  <thead>
    <tr>
      <th>Report Name</th>
      <th>Download</th>
    </tr>
  </thead>
  <tbody>

    {% for f in site.static_files %}
      {% if f.path contains report_root %}
        {% unless f.path contains "/_site/" %}

          {% unless seen_paths contains f.path %}
            {% assign seen_paths = seen_paths | push: f.path %}

            {% assign filename = f.path | split: "/" | last %}
            {% assign ext = filename | split: "." | last | downcase %}

            {% if ext == "png" %}
              {% assign base = filename | split: "." | first %}

              {%- comment -%}
              Title-case the report name and replace "_" with spaces (preserve spaces!)
              {%- endcomment -%}
              {% capture report_name_tc %}
                {% assign words = base | replace: "_", " " | split: " " %}
                {% for w in words %}
                  {{ w | capitalize }}{% unless forloop.last %}{{ " " }}{% endunless %}
                {% endfor %}
              {% endcapture %}

              {% assign row_count = row_count | plus: 1 %}

              <tr>
                <td>
                  <a href="{{ f.path | relative_url }}"
                     target="_blank" rel="noopener noreferrer">
                    {{ report_name_tc | strip }}
                  </a>
                </td>
                <td>
                  {% if xlsx_bases contains base %}
                    <a href="{{ report_root | append: base | append: '.xlsx' | relative_url }}"
                       target="_blank" rel="noopener noreferrer">
                      Download
                    </a>
                  {% endif %}
                </td>
              </tr>
            {% endif %}

          {% endunless %}
        {% endunless %}
      {% endif %}
    {% endfor %}

    {% if row_count == 0 %}
      <tr>
        <td colspan="2"><em>No management reports found.</em></td>
      </tr>
    {% endif %}

  </tbody>
</table>